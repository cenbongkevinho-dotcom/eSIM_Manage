# eSIM_Manage 实施路线图与里程碑（初版）

版本：v0.1  
最后更新：2025-10-29

## 阶段目标

### M0（第 1-4 周）：最小可用产品（MVP）
- 完成 1 家运营商沙盒接入（SM-DP+ Webhook 测试通过）。
- 支持零售激活流程：下单→激活码→LPA 激活→状态回调→订阅启用。
- 管理后台最小功能：运营商配置、套餐上架、订单与订阅列表。
- 观测：基础指标与日志、失败重试机制上线。
- 访问边界：明确项目为企业内部、默认仅内网访问；API 网关启用最小可用的鉴权与限流策略。

### M1（第 5-10 周）：企业与流量池、基础财务闭环
- 企业批量激活：CSV 与 API 双通道，批次状态报告与异常重试。
- 企业流量池：配额管理、阈值告警与自动扩容策略；报表与导出。
- 计费与开票：用量采集（沙盒/模拟）、规则引擎、发票生成与支付回调。
- 后端双栈落地（Go + Python 初步）：
  - Go：订单/订阅/计费等核心服务上线，统一日志/指标/追踪与审计；对外 REST/gRPC。
  - Python：市场抓取、定价仿真与 ETL 作业；任务编排（Celery/Airflow）与观测集成。
  - 服务互通：gRPC/REST/Kafka 事件流；契约测试初步接入 CI。

### M2（第 11-16 周）：渠道与动态定价、全面报表
- 渠道门户：批发价目表、订单履约与对账。
- 动态定价与仿真：引入竞价策略引擎与 A/B 测试框架。
- 报表中心：SLA、销量、毛利、留存与异常分析。
- 合规强化：审计留存、证书轮换演练、隐私合规评估。
- 轻量 CRM 与外部 CRM 集成：客户/供应商/联系人主数据；完成 1 种外部 CRM（如 Salesforce/HubSpot）沙盒联通，支持单/双向同步、字段映射与冲突策略，限流与重试机制落地，观测指标与审计完善。
- 双栈与安全完善：
  - 契约测试覆盖率提升（≥ 90% 端点），双栈兼容性与性能基线确立；
  - 内网访问控制策略完善（IP 白名单/VPN/零信任入口），WAF 与速率限制（429 + Retry-After）全面落地；
  - 市场抓取合规与风控说明对齐至 OpenAPI 与 README，触发限流的客户端退避策略在 SDK/示例中体现。

### M2+（第 15-20 周）：研发过程管理（看板/工时/燃尽图/报表）与复用维度
- 看板与任务：交付 /boards、/boards/{id}/columns、/tasks 端点与最小管理后台页面；OAuth scopes（boards/tasks）生效。
- 工时记录：交付 /worklogs 端点与报表聚合接口；记录计费标记与渠道/活动维度（marketId/campaignId/channel/currency）。
- 迭代与燃尽：交付 /sprints 与 /sprints/{id}/burndown；燃尽点序列（BurndownPoint）校验与图表展示。
- 报表复用：交付 /reports 快照查询，支持产品研发与营销营收维度的复用（filters 与 metadata）。
- CI 契约测试：新增看板/任务/工时/迭代/报表端点的 Dredd/Schemathesis 测试；幂等与限流（429 + Retry-After）覆盖；报告归档。
- 权限矩阵推广：更新角色到 scopes 映射（PM/Team/Finance/Auditor），落地到网关策略与后端鉴权。
- 观测与审计：统一 X-Correlation-ID、审计日志与保留期；对工时与报表访问做审计标记。

验收标准（M2+ 补充）：
- API 覆盖：看板/任务/工时/迭代/报表端点契约测试通过率 ≥ 95%。
- 幂等与限流：写操作幂等行为正确；高并发压测下 429 响应遵循 Retry-After，客户端重试成功率 ≥ 95%。
- 报表复用：ReportSnapshot 可按 marketId/campaignId/channel/currency 维度过滤并生成快照；前端与导出一致。
- 权限与合规：角色到 scopes 映射在端到端联调中有效；跨租户越权访问被拒绝且可审计。

### M3（第 17+ 周）：多区域与高可用、性能与成本优化
- 多区域部署与容灾演练，SLA 达标（≥99.95%）。
- 性能专项：激活峰值并发、Webhook 有序与高吞吐；资源/成本优化。

## 验收标准（摘要）
- 运营商沙盒激活成功率 ≥ 99%，失败均可诊断与重试。
- 企业批量激活支持百万级队列处理与清晰的错误报告。
- 流量池阈值与自动扩容策略行为可追踪且可审计。
- 计费与开票闭环打通，财务数据可对账与追溯。
- 安全与合规清单通过，重大漏洞清零。
- CRM 集成验收：双向同步成功率 ≥ 98%，映射覆盖率 ≥ 95%，重复合并准确率 ≥ 95%，限流场景下单记录重试次数 ≤ 3，DLQ 可观测与可恢复；提供状态查询与审计报表。

## 风险与缓解
- 运营商接口差异：建立适配层与字段映射表，回调事件统一标准化。
- 设备兼容性：维护知识库与自助指引，客服工具与可视化排障。
- 用量数据延迟：引入补偿逻辑与人工复核流程；账单差异标注与再计算。
- 跨境税务与支付：采用本地支付网关与税务配置模块，分阶段上线。
